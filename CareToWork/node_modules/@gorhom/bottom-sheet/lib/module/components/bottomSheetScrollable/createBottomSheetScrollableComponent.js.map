{"version":3,"sources":["createBottomSheetScrollableComponent.tsx"],"names":["React","forwardRef","useImperativeHandle","useMemo","useRef","Platform","useAnimatedProps","useAnimatedStyle","NativeViewGestureHandler","BottomSheetDraggableView","BottomSheetRefreshControl","useScrollHandler","useScrollableSetter","useBottomSheetInternal","GESTURE_SOURCE","SCROLLABLE_DECELERATION_RATE_MAPPER","SCROLLABLE_STATE","styles","createBottomSheetScrollableComponent","type","ScrollableComponent","props","ref","focusHook","scrollEventsHandlersHook","enableFooterMarginAdjustment","overScrollMode","keyboardDismissMode","showsVerticalScrollIndicator","style","refreshing","onRefresh","progressViewOffset","refreshControl","rest","nativeGestureRef","refreshControlGestureRef","scrollableRef","scrollableContentOffsetY","scrollHandler","enableContentPanningGesture","animatedFooterHeight","animatedScrollableState","scrollableAnimatedProps","decelerationRate","value","UNLOCKED","containerAnimatedStyle","marginBottom","containerStyle","current","undefined","OS","scrollableContent","SCROLLABLE","container"],"mappings":"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","sourcesContent":["import React, { forwardRef, useImperativeHandle, useMemo, useRef } from 'react';\nimport { Platform } from 'react-native';\nimport { useAnimatedProps, useAnimatedStyle } from 'react-native-reanimated';\nimport { NativeViewGestureHandler } from 'react-native-gesture-handler';\nimport BottomSheetDraggableView from '../bottomSheetDraggableView';\nimport BottomSheetRefreshControl from '../bottomSheetRefreshControl';\nimport {\n  useScrollHandler,\n  useScrollableSetter,\n  useBottomSheetInternal,\n} from '../../hooks';\nimport {\n  GESTURE_SOURCE,\n  SCROLLABLE_DECELERATION_RATE_MAPPER,\n  SCROLLABLE_STATE,\n  SCROLLABLE_TYPE,\n} from '../../constants';\nimport { styles } from './styles';\n\nexport function createBottomSheetScrollableComponent<T, P>(\n  type: SCROLLABLE_TYPE,\n  ScrollableComponent: any\n) {\n  return forwardRef<T, P>((props, ref) => {\n    // props\n    const {\n      // hooks\n      focusHook,\n      scrollEventsHandlersHook,\n      // props\n      enableFooterMarginAdjustment = false,\n      overScrollMode = 'never',\n      keyboardDismissMode = 'interactive',\n      showsVerticalScrollIndicator = true,\n      style,\n      refreshing,\n      onRefresh,\n      progressViewOffset,\n      refreshControl,\n      ...rest\n    }: any = props;\n\n    //#region refs\n    const nativeGestureRef = useRef<NativeViewGestureHandler>(null);\n    const refreshControlGestureRef = useRef<NativeViewGestureHandler>(null);\n    //#endregion\n\n    //#region hooks\n    const { scrollableRef, scrollableContentOffsetY, scrollHandler } =\n      useScrollHandler(scrollEventsHandlersHook);\n    const {\n      enableContentPanningGesture,\n      animatedFooterHeight,\n      animatedScrollableState,\n    } = useBottomSheetInternal();\n    //#endregion\n\n    //#region variables\n    const scrollableAnimatedProps = useAnimatedProps(\n      () => ({\n        decelerationRate:\n          SCROLLABLE_DECELERATION_RATE_MAPPER[animatedScrollableState.value],\n        showsVerticalScrollIndicator: showsVerticalScrollIndicator\n          ? animatedScrollableState.value === SCROLLABLE_STATE.UNLOCKED\n          : showsVerticalScrollIndicator,\n      }),\n      [showsVerticalScrollIndicator]\n    );\n    //#endregion\n\n    //#region styles\n    const containerAnimatedStyle = useAnimatedStyle(\n      () => ({\n        marginBottom: enableFooterMarginAdjustment\n          ? animatedFooterHeight.value\n          : 0,\n      }),\n      [enableFooterMarginAdjustment]\n    );\n    const containerStyle = useMemo(() => {\n      return enableFooterMarginAdjustment\n        ? [\n            ...(style ? ('length' in style ? style : [style]) : []),\n            containerAnimatedStyle,\n          ]\n        : style;\n    }, [enableFooterMarginAdjustment, style, containerAnimatedStyle]);\n    //#endregion\n\n    //#region effects\n    // @ts-ignore\n    useImperativeHandle(ref, () => scrollableRef.current);\n    useScrollableSetter(\n      scrollableRef,\n      type,\n      scrollableContentOffsetY,\n      onRefresh !== undefined,\n      focusHook\n    );\n    //#endregion\n\n    //#region render\n    if (Platform.OS === 'android') {\n      const scrollableContent = (\n        <NativeViewGestureHandler\n          ref={nativeGestureRef}\n          enabled={enableContentPanningGesture}\n          shouldCancelWhenOutside={false}\n        >\n          <ScrollableComponent\n            animatedProps={scrollableAnimatedProps}\n            {...rest}\n            scrollEventThrottle={16}\n            ref={scrollableRef}\n            overScrollMode={overScrollMode}\n            keyboardDismissMode={keyboardDismissMode}\n            onScroll={scrollHandler}\n            style={containerStyle}\n          />\n        </NativeViewGestureHandler>\n      );\n      return (\n        <BottomSheetDraggableView\n          nativeGestureRef={nativeGestureRef}\n          refreshControlGestureRef={refreshControlGestureRef}\n          gestureType={GESTURE_SOURCE.SCROLLABLE}\n          style={styles.container}\n        >\n          {onRefresh ? (\n            <BottomSheetRefreshControl\n              ref={refreshControlGestureRef}\n              refreshing={refreshing}\n              onRefresh={onRefresh}\n              progressViewOffset={progressViewOffset}\n              style={styles.container}\n            >\n              {scrollableContent}\n            </BottomSheetRefreshControl>\n          ) : (\n            scrollableContent\n          )}\n        </BottomSheetDraggableView>\n      );\n    }\n    return (\n      <BottomSheetDraggableView\n        nativeGestureRef={nativeGestureRef}\n        gestureType={GESTURE_SOURCE.SCROLLABLE}\n        style={styles.container}\n      >\n        <NativeViewGestureHandler\n          ref={nativeGestureRef}\n          enabled={enableContentPanningGesture}\n          shouldCancelWhenOutside={false}\n        >\n          <ScrollableComponent\n            animatedProps={scrollableAnimatedProps}\n            {...rest}\n            scrollEventThrottle={16}\n            ref={scrollableRef}\n            overScrollMode={overScrollMode}\n            keyboardDismissMode={keyboardDismissMode}\n            refreshing={refreshing}\n            onRefresh={onRefresh}\n            progressViewOffset={progressViewOffset}\n            refreshControl={refreshControl}\n            onScroll={scrollHandler}\n            style={containerStyle}\n          />\n        </NativeViewGestureHandler>\n      </BottomSheetDraggableView>\n    );\n    //#endregion\n  });\n}\n"]}