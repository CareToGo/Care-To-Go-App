var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));var _assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));var _inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits"));var _possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));var _getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));var _react=_interopRequireDefault(require("react"));var _reactNative=require("react-native");var _awsAmplify=require("aws-amplify");var _AmplifyUI=require("../AmplifyUI");var _AmplifyTheme=_interopRequireDefault(require("../AmplifyTheme"));var _AuthPiece2=_interopRequireDefault(require("./AuthPiece"));var _AmplifyTestIDs=_interopRequireDefault(require("../AmplifyTestIDs"));var _Utils=require("../Utils");var _jsxFileName="/root/amplify-js/packages/aws-amplify-react-native/src/Auth/Greetings.tsx";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=(0,_getPrototypeOf2.default)(Derived),result;if(hasNativeReflectConstruct){var NewTarget=(0,_getPrototypeOf2.default)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return(0,_possibleConstructorReturn2.default)(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}var Greetings=function(_AuthPiece){(0,_inherits2.default)(Greetings,_AuthPiece);var _super=_createSuper(Greetings);function Greetings(props){var _this;(0,_classCallCheck2.default)(this,Greetings);_this=_super.call(this,props);_this._validAuthStates=['signedIn'];_this.signOut=_this.signOut.bind((0,_assertThisInitialized2.default)(_this));_this.getMessage=_this.getMessage.bind((0,_assertThisInitialized2.default)(_this));return _this;}(0,_createClass2.default)(Greetings,[{key:"signOut",value:function signOut(){var _this2=this;_awsAmplify.Auth.signOut().then(function(){return _this2.changeState('signedOut');}).catch(function(err){return _this2.error(err);});}},{key:"getMessage",value:function getMessage(){var authData=this.props.authData;var defaultMessage='';var user=authData;if(user){var _this$props$usernameA=this.props.usernameAttributes,usernameAttributes=_this$props$usernameA===void 0?[]:_this$props$usernameA;var name='';if(usernameAttributes==='email'){name=user.attributes?user.attributes.email:user.username;defaultMessage=""+name;}else if(usernameAttributes==='phone_number'){name=user.attributes?user.attributes.phone_number:user.username;defaultMessage=""+name;}else{name=user.username||'unknown user';defaultMessage=_awsAmplify.I18n.get('Hello')+" "+name;}}return this.props.signedInMessage||defaultMessage;}},{key:"showComponent",value:function showComponent(){var theme=this.props.theme||_AmplifyTheme.default;return _react.default.createElement(_reactNative.View,{style:theme.navBar,__self:this,__source:{fileName:_jsxFileName,lineNumber:73,columnNumber:4}},_react.default.createElement(_reactNative.Text,(0,_extends2.default)({style:theme.greetingMessage},(0,_Utils.setTestId)(_AmplifyTestIDs.default.AUTH.GREETING_SIGNED_IN_TEXT),{__self:this,__source:{fileName:_jsxFileName,lineNumber:74,columnNumber:5}}),this.getMessage()),_react.default.createElement(_AmplifyUI.AmplifyButton,(0,_extends2.default)({theme:theme,text:_awsAmplify.I18n.get('Sign Out'),onPress:this.signOut,style:theme.navButton},(0,_Utils.setTestId)(_AmplifyTestIDs.default.AUTH.SIGN_OUT_BUTTON),{__self:this,__source:{fileName:_jsxFileName,lineNumber:80,columnNumber:5}})));}}]);return Greetings;}(_AuthPiece2.default);exports.default=Greetings;